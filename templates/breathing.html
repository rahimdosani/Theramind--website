<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Theramind ‚Äì Breathe</title>
  <link rel="icon" href="https://img.icons8.com/fluency/48/breathing.png" type="image/png" />


  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@3/tsparticles.bundle.min.js"></script>
  <style>
    :root{
      --accent:#4f6df5;
      --accent-dark:#3e53cc;
      --glass-light:rgba(255,255,255,0.55);
      --glass-dark:rgba(20,20,40,0.55);
      --card-light:rgba(255,255,255,0.12);
      --card-dark:rgba(44,44,62,0.85);
      --ok:#10b981;
      --warn:#f59e0b;
      --danger:#ef4444;
      --background: #ffffff;
      --foreground: #111111;
      --primary: #4f46e5;
      --accent2: #06b6d4;
      --sidebar-bg: rgba(255,255,255,0.85);
      --glass-blur: blur(16px) saturate(180%);
      --button-color: #ffffff;
    }
    body.dark-theme {
      --background: #0d0d0f;
      --foreground: #f0f0f0;
      --primary: #6366f1;
      --accent2: #67e8f9;
      --sidebar-bg: rgba(30,30,30,0.85);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Poppins',sans-serif;
      background: var(--bg-gradient);
      background-size:cover;
      background-attachment:fixed;
      transition: background 0.4s ease, color 0.3s ease;
      overflow-x:hidden;
    }
    body.light{
      --bg-gradient: linear-gradient(180deg, rgba(238,241,255,0.9), rgba(200,210,255,0.5)), url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=60') no-repeat center center / cover;
      color:#1e1e2f;
    }
    body.dark-theme{
      --bg-gradient: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(10,10,18,0.8)), url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=60') no-repeat center center / cover;
      color:#f0f0f0;
    }

    #tsparticles{position:fixed;inset:0;z-index:0}

    /* ===================== Navbar ===================== */
    header.tm-nav {
      display:flex;
      align-items:center;
      justify-content:space-between;
      height:75px;
      padding:0 2rem;
      background: var(--sidebar-bg);
      backdrop-filter: var(--glass-blur);
      box-shadow: 0 6px 25px rgba(0,0,0,0.15);
      position: sticky;
      top:0;
      z-index: 100;
    }
    .tm-brand {
      display:flex;
      align-items:center;
      gap:0.75rem;
      font-weight:700;
      font-size:1.4rem;
      color: var(--foreground);
      text-decoration:none;
    }
    .tm-brand img.brand-mark { height:36px; }
    .tm-navlinks {
      display:flex;
      gap:1.5rem;
      align-items:center;
      flex-wrap:wrap;
    }
    .tm-navlinks a {
      text-decoration:none;
      font-weight:600;
      color: var(--primary);
      position: relative;
      transition: color 0.3s;
    }
    .tm-navlinks a:hover { color: var(--accent2); }
    .tm-navlinks a.active::after {
      content:''; position:absolute; bottom:-6px; left:0; width:100%; height:3px;
      background: var(--primary); border-radius:4px;
    }
    .theme-toggle {
      cursor:pointer;
      font-size:0.9rem;
      background: linear-gradient(135deg,var(--primary),var(--accent2));
      padding:6px 10px;
      border-radius:6px;
      color: var(--button-color);
      transition:0.3s;
    }
    .theme-toggle:hover { opacity:0.85; }
    .tm-hamburger{display:none; cursor:pointer; font-size:1.4rem}

    @media (max-width:768px){
      header.tm-nav { flex-direction:column; align-items:flex-start; height:auto; padding:1rem; }
      .tm-navlinks { flex-direction:column; align-items:flex-start; width:100%; gap:0.6rem; margin-top:0.5rem; }
      .theme-toggle { align-self:flex-start; margin-top:0.5rem; }
      .tm-nav.show-links .tm-navlinks{display:flex;}
    }

    /* Card container */
    .breathe-container{
      max-width: 900px;
      margin: 80px auto 120px;
      padding: 32px 28px;
      border-radius: 24px;
      background: var(--card-light);
      backdrop-filter: blur(18px);
      box-shadow: 0 10px 50px rgba(0,0,0,0.25);
      position:relative; z-index:1;
    }
    body.dark-theme .breathe-container{ background: var(--card-dark); }

    .breathe-header{display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:12px}
    .breathe-header h2{margin:0;font-size:1.8rem}
    .subtle{opacity:0.85}

    .stage{ display:grid; place-items:center; margin: 24px auto; width:100%; min-height:340px; border-radius:20px; position:relative; overflow:hidden; }
    .orb{ width: 220px; height: 220px; border-radius:50%; background: radial-gradient(circle at 30% 30%, #a8b4ff, #6f8cfa 40%, #4757d6 70%, #2f2fa2 100%); box-shadow: 0 0 40px rgba(79,109,245,0.6), inset 0 0 40px rgba(255,255,255,0.25); transform: scale(1); transition: transform 1s ease; }
    .lotus-wrap{width:260px;height:260px}
    .lotus svg{width:100%;height:100%}
    .lotus .petal{transform-origin: 130px 130px; opacity:0.95}
    .lotus .center{filter: drop-shadow(0 0 8px rgba(255,255,255,0.5));}
    .waves{position:relative; width:280px;height:280px}
    .wave{position:absolute; inset:0; border-radius:50%; border:2px solid rgba(79,109,245,0.35); opacity:0.6; transform: scale(1); transition: transform 1s ease, opacity 1s ease}
    .wave:nth-child(2){inset:12px} .wave:nth-child(3){inset:24px}

    .panel{display:grid; grid-template-columns:1fr auto auto; gap:12px; align-items:center; margin-top: 6px;}
    #instruction{font-size:1.35rem}
    .chip{padding:8px 12px; border-radius:999px; background: rgba(79,109,245,0.1); color:inherit; font-weight:600; min-width:120px; text-align:center;}

    .controls{display:flex; flex-wrap:wrap; gap:10px; margin-top:18px}
    .btn, .select, .range{appearance:none; border:none; border-radius:12px; padding:12px 16px; font-weight:600; cursor:pointer; background: var(--accent); color:#fff; transition: transform .06s ease, background .2s ease;}
    .btn:active{ transform: translateY(1px) }
    .btn.secondary{ background: rgba(79,109,245,0.2); color: inherit }
    .btn.warn{ background: var(--warn); color:#000 }
    .btn.ok{ background: var(--ok); color:#000 }
    .btn.ghost{ background: rgba(0,0,0,0.12); color:inherit }
    .select{ background:#fff; color:#1e1e2f }
    body.dark-theme .select{ background:#27273a; color:#f0f0f0 }
    .range{ background: transparent; padding:0 }
    input[type="range"]{ width:200px }

    #quote{margin-top:22px; font-style:italic; opacity:0.9}
    .toast{position:fixed; left:50%; bottom:22px; transform:translateX(-50%) translateY(20px); background:#1f2937; color:#fff; padding:12px 18px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.25); opacity:0; pointer-events:none; transition: .28s ease; z-index:9999; font-weight:600;}
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(0) }
 /* ========== Responsive Adjustments (Final Ready Version) ========== */
@media (max-width: 1024px) {
  .breathe-container { padding: 20px 16px; margin-top: 60px; }
  .stage { min-height: 220px; }
  .orb, .lotus-wrap, .waves { width: 160px; height: 160px; }
}

@media (max-width: 768px) {
  header.tm-nav { flex-direction: column; align-items: flex-start; height: auto; padding: 1rem; }
  .tm-navlinks { flex-direction: column; gap: 0.6rem; width: 100%; margin-top: 0.5rem; }
  .theme-toggle { align-self: flex-start; margin-top: 0.5rem; font-size: 0.85rem; padding: 5px 8px; }
  .tm-hamburger { display: block; }
  .breathe-header { flex-direction: column; align-items: flex-start; gap: 6px; }
  .panel { grid-template-columns: 1fr; gap: 6px; }
  .controls { flex-direction: column; gap: 6px; }
  .controls .btn, .controls .select, .controls .range { max-width: 100%; font-size: 0.9rem; padding: 10px 14px; }
}

@media (max-width: 600px) {
  .orb, .lotus-wrap, .waves { width: 140px; height: 140px; }
  #instruction { font-size: 1rem; }
  .badge { font-size: 0.75rem; }
  .chip { font-size: 0.75rem; padding: 5px 8px; min-width: 80px; }
}

@media (max-width: 480px) {
  .orb, .lotus-wrap, .waves { width: 130px; height: 130px; }
  #instruction { font-size: 0.95rem; }
  .badge, .chip { font-size: 0.7rem; }
  .controls .btn, .controls .select, .controls .range { font-size: 0.85rem; padding: 8px 12px; }
}

@media (max-width: 400px) {
  header.tm-nav { padding: 0.5rem 1rem; }
  .tm-brand { font-size: 1.1rem; }
  .theme-toggle { font-size: 0.75rem; padding: 4px 6px; }
  .orb, .lotus-wrap, .waves { width: 120px; height: 120px; }
  #instruction { font-size: 0.9rem; }
  .badge, .chip { font-size: 0.65rem; padding: 4px 6px; min-width: 70px; }
}

@media (max-width: 360px) {
  .orb, .lotus-wrap, .waves { width: 110px; height: 110px; }
  #instruction { font-size: 0.85rem; }
  .badge, .chip { font-size: 0.6rem; padding: 3px 5px; min-width: 65px; }
  .controls .btn, .controls .select, .controls .range { font-size: 0.8rem; padding: 6px 10px; }
}


  </style>
</head>
<body class="light">
  <div id="tsparticles"></div>

  <header class="tm-nav">
    <a class="tm-brand" href="/home">
      <img src="https://img.icons8.com/fluency/48/brain.png" alt="Theramind Logo" class="brand-mark">
      <span>Theramind</span>
    </a>
    <div class="tm-hamburger">‚ò∞</div>
    <nav class="tm-navlinks">
      <a href="/">üè† Home</a>
      <a href="/index">üí¨ Chat</a>
      <a href="/journaling">üìì Journal</a>
      <a href="/breathing">ü´Å Breathing</a>
      <a href="/pick-a-peace">üìÉ Pick-a-Peace</a>
      <a href="/calm-corner">üßò Calm Corner</a>
      <a href="/ebooks">üìö E-Books</a>
      <a href="/history">üï∞Ô∏è History</a>
    </nav>
    <div class="theme-toggle" id="themeToggle">üåì Theme</div>
  </header>

  <!-- MAIN CARD -->
  <div class="breathe-container">
    <div class="breathe-header">
      <h2>Relax and Breathe</h2>
      <div class="badge">Shortcuts: <span class="kbd">Space</span> Start/Pause ¬∑ <span class="kbd">R</span> Reset</div>
    </div>

    <div class="stage">
      <div class="orb visual" id="visual-orb" aria-hidden="true"></div>
      <div class="lotus-wrap visual" id="visual-lotus" style="display:none" aria-hidden="true">
        <svg viewBox="0 0 260 260" class="lotus" role="img" aria-label="Lotus breathing visual">
          <g id="petals">
            <defs>
              <path id="petalPath" d="M130 35 C115 80, 115 120, 130 150 C145 120,145 80,130 35 Z" />
              <radialGradient id="petalGrad" cx="50%" cy="35%">
                <stop offset="0%" stop-color="#ffffff" stop-opacity="0.9"/>
                <stop offset="45%" stop-color="#a7c0ff" stop-opacity="0.9"/>
                <stop offset="100%" stop-color="#6f8cfa" stop-opacity="1"/>
              </radialGradient>
            </defs>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(0 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(45 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(90 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(135 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(180 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(225 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(270 130 130)"/>
            <use href="#petalPath" class="petal" fill="url(#petalGrad)" transform="rotate(315 130 130)"/>
          </g>
          <circle class="center" cx="130" cy="130" r="22" fill="#cfe0ff" stroke="#7e9bff" stroke-width="3"/>
        </svg>
      </div>

      <div class="waves visual" id="visual-waves" style="display:none" aria-hidden="true">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
      </div>
    </div>

    <div class="panel">
      <div id="instruction" class="subtle">Click ‚ÄúStart‚Äù to begin.</div>
      <div class="chip">Breaths: <span id="breath-count">0</span></div>
      <div class="chip">Mode: <span id="mode-label">Simple</span></div>
    </div>

    <div class="controls" role="group" aria-label="Breathing controls">
      <button class="btn ok" id="start-btn">Start</button>
      <button class="btn warn" id="stop-btn">Pause</button>
      <button class="btn secondary" id="reset-btn">Reset Count</button>

      <select class="select" id="mode-select" title="Breathing Mode">
        <option value="simple">Simple (4‚Äì4)</option>
        <option value="box">Box (4‚Äì4‚Äì4‚Äì4)</option>
        <option value="478">4‚Äì7‚Äì8</option>
      </select>

      <select class="select" id="visual-select" title="Visual Style">
        <option value="orb">Orb</option>
        <option value="waves">Waves</option>
      </select>

      <label class="btn ghost" style="display:flex; align-items:center; gap:10px;">
        Pace <input type="range" id="pace" min="0.6" max="1.6" step="0.05" value="1"/>
      </label>

      <button class="btn" id="speech-btn">üîá Speech</button>
      <button class="btn" id="sound-btn">üîï Chime</button>
    </div>

    <div id="quote">‚ÄúFeelings come and go like clouds in a windy sky. Conscious breathing is my anchor.‚Äù</div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
  document.addEventListener("DOMContentLoaded", ()=>{

    // ====== Active Nav Link ======
    const currentPath = window.location.pathname;
    document.querySelectorAll(".tm-navlinks a").forEach(link => {
      if(currentPath.includes(link.getAttribute("href"))) link.classList.add("active");
    });

    // ====== Theme Toggle ======
    const themeBtn = document.getElementById("themeToggle");
    const darkStored = localStorage.getItem("theme")==="dark";
    if(darkStored){ document.body.classList.add("dark-theme"); document.body.classList.remove("light"); themeBtn.textContent="‚òÄÔ∏è Theme"; }
    else { document.body.classList.remove("dark-theme"); document.body.classList.add("light"); themeBtn.textContent="üåô Theme"; }
    themeBtn.addEventListener("click", ()=>{
      const isDark = document.body.classList.toggle("dark-theme");
      document.body.classList.toggle("light", !isDark);
      localStorage.setItem("theme", isDark?"dark":"light");
      themeBtn.textContent = isDark?"‚òÄÔ∏è Theme":"üåô Theme";
    });

    // ====== Hamburger ======
    const hamburger = document.querySelector('.tm-hamburger');
    const nav = document.querySelector('.tm-nav');
    function updateHamburger(){ hamburger.style.display=(window.innerWidth<=768)?"block":"none"; nav.classList.remove('show-links'); }
    hamburger.addEventListener('click', ()=>nav.classList.toggle('show-links'));
    updateHamburger();
    window.addEventListener('resize', updateHamburger);
    tsParticles.load("tsparticles", {
      particles: {
        number: { value: 60, density: { enable: true, area: 800 } },
        color: { value: ["#4f6df5","#67e8f9","#a8b4ff"] },
        shape: { type: "circle" },
        opacity: { value: 0.6, random: true },
        size: { value: 3, random: { enable: true, minimumValue: 1 } },
        move: { enable: true, speed: 0.8, direction: "none", outModes: "out" }
      },
      interactivity: {
        events: { onHover: { enable: true, mode: "repulse" }, onClick: { enable: true, mode: "push" } },
        modes: { repulse: { distance: 80 }, push: { quantity: 4 } }
      },
      detectRetina: true
    });

    // ====== Toast ======
    const toast = document.getElementById("toast");
    function showToast(msg, duration=2200){
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), duration);
    }

    // ====== Breathing Logic ======
    const startBtn = document.getElementById("start-btn");
    const stopBtn = document.getElementById("stop-btn");
    const resetBtn = document.getElementById("reset-btn");
    const modeSelect = document.getElementById("mode-select");
    const visualSelect = document.getElementById("visual-select");
    const paceRange = document.getElementById("pace");
    const speechBtn = document.getElementById("speech-btn");
    const soundBtn = document.getElementById("sound-btn");
    const instruction = document.getElementById("instruction");
    const breathCountEl = document.getElementById("breath-count");
    const modeLabelEl = document.getElementById("mode-label");

    let breathCount = 0;
    let intervalId = null;
    let pace = 1.0;
    let mode = modeSelect.value;
    let visual = visualSelect.value;
    let speechEnabled = false;
    let chimeEnabled = false;

    function updateVisual(){
      document.getElementById("visual-orb").style.display = (visual==="orb")?"block":"none";
      document.getElementById("visual-waves").style.display = (visual==="waves")?"block":"none";
      document.getElementById("visual-lotus").style.display = (visual==="lotus")?"block":"none";
    }

    function updateInstruction(msg){ instruction.textContent = msg; }

    function breatheCycle(){
      breathCount++;
      breathCountEl.textContent = breathCount;
      updateInstruction("Inhale‚Ä¶ Exhale‚Ä¶");
      const orb = document.getElementById("visual-orb");
      if(visual==="orb") orb.style.transform = "scale(1.3)";
      setTimeout(()=>{ if(visual==="orb") orb.style.transform="scale(1)"; }, 2000/pace);
      if(chimeEnabled) new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg").play();
      if(speechEnabled && 'speechSynthesis' in window){
        const utter = new SpeechSynthesisUtterance("Breathe in‚Ä¶ Breathe out‚Ä¶");
        speechSynthesis.speak(utter);
      }
    }

    function startBreathing(){
      if(intervalId) return;
      intervalId = setInterval(breatheCycle, 4000/pace);
      updateInstruction("Breathing started. Follow the visual.");
      showToast("Breathing started");
    }

    function stopBreathing(){
      clearInterval(intervalId);
      intervalId = null;
      updateInstruction("Paused. Click Start to continue.");
      showToast("Breathing paused");
    }

    function resetBreathing(){
      breathCount = 0;
      breathCountEl.textContent = 0;
      stopBreathing();
      updateInstruction("Click Start to begin.");
      showToast("Breathing reset");
    }

    startBtn.addEventListener("click", startBreathing);
    stopBtn.addEventListener("click", stopBreathing);
    resetBtn.addEventListener("click", resetBreathing);

    modeSelect.addEventListener("change", e=>{
      mode = e.target.value;
      modeLabelEl.textContent = e.target.selectedOptions[0].text;
      showToast(`Mode changed to ${e.target.selectedOptions[0].text}`);
    });

    visualSelect.addEventListener("change", e=>{
      visual = e.target.value;
      updateVisual();
      showToast(`Visual changed to ${visual}`);
    });

    paceRange.addEventListener("input", e=>{
      pace = parseFloat(e.target.value);
      showToast(`Pace set to ${pace.toFixed(2)}x`);
      if(intervalId) stopBreathing(), startBreathing();
    });

    speechBtn.addEventListener("click", ()=>{
      speechEnabled = !speechEnabled;
      speechBtn.textContent = speechEnabled?"üîä Speech":"üîá Speech";
      showToast(speechEnabled?"Speech enabled":"Speech disabled");
    });

    soundBtn.addEventListener("click", ()=>{
      chimeEnabled = !chimeEnabled;
      soundBtn.textContent = chimeEnabled?"üîî Chime":"üîï Chime";
      showToast(chimeEnabled?"Chime enabled":"Chime disabled");
    });

    document.addEventListener("keydown", e=>{
      if(e.code==="Space"){ e.preventDefault(); intervalId?stopBreathing():startBreathing(); }
      if(e.code==="KeyR"){ e.preventDefault(); resetBreathing(); }
    });

    updateVisual(); // initialize visual
  });
  </script>
</body>
</html>

