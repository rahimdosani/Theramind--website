<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Create your calm space ‚Äî Theramind</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='brain.png') }}">

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

  <style>
    :root {
      --bg1:#eef2ff;
      --bg2:#f8fafc;
      --card:rgba(255,255,255,.65);
      --border:rgba(255,255,255,.4);
      --text:#1e1e2f;
      --muted:#6b7280;
      --accent:#4f6df5;
      --accent-soft:rgba(79,109,245,.15);
      --shadow:0 30px 60px rgba(0,0,0,.12);
    }

    body.dark {
      --bg1:#0b0c1a;
      --bg2:#0f1224;
      --card:rgba(20,20,35,.7);
      --border:rgba(255,255,255,.08);
      --text:#ffffff;
      --muted:#9ca3af;
      --accent:#7f8cff;
      --accent-soft:rgba(127,140,255,.2);
      --shadow:0 30px 60px rgba(0,0,0,.6);
    }

    * { box-sizing:border-box }

    body {
      margin:0;
      min-height:100dvh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto;
      background:
        radial-gradient(circle at top,#c7d2fe,transparent 55%),
        linear-gradient(180deg,var(--bg1),var(--bg2));
      color:var(--text);
    }

    #particles-js {
      position:fixed;
      inset:0;
      z-index:0;
      pointer-events:none;
    }

    .wrap {
      min-height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px 16px;
      position:relative;
      z-index:1;
    }

    .card {
      width:100%;
      max-width:420px;
      background:var(--card);
      backdrop-filter:blur(18px);
      border:1px solid var(--border);
      border-radius:24px;
      padding:30px 28px;
      box-shadow:var(--shadow);
      animation:fadeUp .6s ease;
    }

    @keyframes fadeUp {
      from { opacity:0; transform:translateY(18px); }
      to { opacity:1; transform:translateY(0); }
    }

    .logo {
      display:flex;
      justify-content:center;
      gap:10px;
      font-size:20px;
      font-weight:700;
      margin-bottom:10px;
    }

    .logo img { width:34px }

    h2 {
      text-align:center;
      margin:6px 0;
      font-size:22px;
    }

    .subtitle {
      text-align:center;
      font-size:14px;
      color:var(--muted);
      margin-bottom:22px;
      line-height:1.6;
    }

    label {
      display:block;
      margin-top:14px;
      font-size:13px;
      color:var(--muted);
    }

    input {
      width:100%;
      padding:12px 14px;
      margin-top:6px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      background:rgba(255,255,255,.9);
      font-size:14px;
    }

    body.dark input {
      background:rgba(20,20,35,.85);
      border-color:#2a2a45;
      color:white;
    }

    input:focus {
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 4px var(--accent-soft);
    }

    .password-wrap {
      position:relative;
    }

    .toggle-pass {
      position:absolute;
      right:14px;
      top:50%;
      transform:translateY(-50%);
      font-size:13px;
      color:var(--accent);
      cursor:pointer;
      user-select:none;
    }

    .intent {
      display:grid;
      gap:10px;
      margin-top:8px;
    }

    .intent input { display:none }

    .intent span {
      display:block;
      padding:14px 16px;
      border-radius:16px;
      border:1.5px solid #e5e7eb;
      background:rgba(255,255,255,.85);
      cursor:pointer;
    }

    body.dark .intent span {
      background:rgba(20,20,35,.85);
      border-color:#2a2a45;
    }

    .intent input:checked + span {
      border-color:var(--accent);
      background:var(--accent-soft);
      box-shadow:0 8px 20px rgba(79,109,245,.25);
    }

    button {
      width:100%;
      padding:14px;
      margin-top:22px;
      border-radius:999px;
      border:none;
      background:linear-gradient(135deg,#4f6df5,#7f87f3);
      color:white;
      font-weight:600;
      font-size:15px;
      cursor:pointer;
      box-shadow:0 10px 30px rgba(79,109,245,.45);
    }

    .google {
      margin-top:14px;
      background:white;
      color:#111;
      border:1px solid #e5e7eb;
      box-shadow:none;
    }

    .flash {
      padding:10px;
      border-radius:10px;
      margin-bottom:12px;
      font-size:13px;
    }

    .flash.danger { background:#fff1f2; color:#b91c1c }
    .flash.success { background:#ecfdf5; color:#065f46 }
    .flash.info { background:#eef2ff; color:#1e3a8a }

    .alt {
      margin-top:18px;
      text-align:center;
      font-size:13px;
      color:var(--muted);
    }

    .alt a {
      color:var(--accent);
      font-weight:600;
      text-decoration:none;
    }
  </style>
</head>

<body>
<div id="particles-js"></div>

<div class="wrap">
  <div class="card">

    <div class="logo">
      <img src="https://img.icons8.com/fluency/48/brain.png">
      Theramind
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for category, msg in messages %}
        <div class="flash {{ category }}">{{ msg }}</div>
      {% endfor %}
    {% endwith %}

    <h2>Create your calm space</h2>
    <div class="subtitle">
      A private, judgment-free place to reflect, breathe, and feel supported.
    </div>

    <form method="post" action="{{ url_for('signup') }}"
          onsubmit="this.querySelector('button').disabled=true">

      <label>What should we call you? (optional)</label>
      <input name="display_name" placeholder="Your name or nickname">

      <label>What brings you to Theramind?</label>
      <div class="intent">
        <label><input type="radio" name="intent" value="exploring" required><span>üå± Just exploring</span></label>
        <label><input type="radio" name="intent" value="stress"><span>üòå Managing stress or anxiety</span></label>
        <label><input type="radio" name="intent" value="overthinking"><span>üí≠ Overthinking or clarity</span></label>
        <label><input type="radio" name="intent" value="habits"><span>üßò Building calm habits</span></label>
        <label><input type="radio" name="intent" value="personal"><span>ü§ç Something personal</span></label>
      </div>

      <label>Email</label>
      <input name="email" type="email" required>

      <label>Create a Theramind password</label>
      <div class="password-wrap">
        <input id="password" name="password" type="password" minlength="8" required>
        <span class="toggle-pass" onclick="togglePassword()">Show</span>
      </div>

      <button type="submit">Send verification code</button>
    </form>

    <a href="{{ url_for('auth_google') }}">
      <button class="google" type="button">Continue with Google</button>
    </a>

    <div class="alt">
      Already have an account?
      <a href="{{ url_for('user_login') }}">Sign in</a>
    </div>

  </div>
</div>

<script>
  const savedTheme = localStorage.getItem("theme");
  if (savedTheme === "dark") document.body.classList.add("dark");

  function togglePassword() {
    const input = document.getElementById("password");
    const toggle = document.querySelector(".toggle-pass");
    input.type = input.type === "password" ? "text" : "password";
    toggle.textContent = input.type === "password" ? "Show" : "Hide";
  }

  const isDark = document.body.classList.contains("dark");

  particlesJS("particles-js", {
    particles:{
      number:{ value:60, density:{ enable:true, value_area:800 }},
      color:{ value:isDark ? "#ffffff" : "#3b5bfd" },
      size:{ value:3, random:true },
      opacity:{ value:isDark ? 0.35 : 0.45 },
      line_linked:{
        enable:true,
        distance:140,
        color:isDark ? "#ffffff" : "#3b5bfd",
        opacity:isDark ? 0.25 : 0.45,
        width:1
      },
      move:{ enable:true, speed:1.1 }
    },
    interactivity:{ events:{ onhover:{ enable:false }, onclick:{ enable:false }}},
    retina_detect:true
  });
</script>
</body>
</html>
